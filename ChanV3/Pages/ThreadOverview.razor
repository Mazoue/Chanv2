@page "/thread/{boardId}/{threadId}"
@page "/thread/{boardId}/{threadId}/{threadTitle}"

<h1>@DisplayTitle</h1>

<table class="headerlayouttable" style="width:100%">
    <tr>
         @*<td> <input type="checkbox" @onchange="eventArgs => { CheckAllClicked(); }" />Check All</td>*@
        <td style="text-align:right"><button type="button" @onclick="@(async () => await PostService.DownloadPostsAsync(@DisplayTitle,@Posts.PostCollection.Where(x => x.Checked),@BoardId).ConfigureAwait(false))"> Download</button></td>
   
    </tr>
</table>
<br />
<br />
<table class="table">
    <thead>
        <tr>
            <th></th>
            <th>Preview</th>
            <th>Post Id</th>
            <th>File Name</th>
            <th>File Extension</th>
            <th>File Size(KB)</th>
            <th>Comment</th>
        </tr>
    </thead>
    <tbody>
        @if (Posts != null)
        {
            var thumbnailPlaceholderCount = 0;

            foreach (var post in Posts.PostCollection.ToList())
            {
                
                if (@post.fsize > 1)
                {
                    thumbnailPlaceholderCount+=1;  
                    var thumbnailPlaceholderId = $"thumbnailPlaceholderId{thumbnailPlaceholderCount}";
                    //href works but redirects to captcha
                    
                    <tr>                        
                        <td> <input @bind=@post.Checked type="checkbox" /></td>                           
                        <td><img id="@_thumbnailPlaceHolderId" /></td>
                        <td>@post.no</td>
                        <td>@post.filename.Trim()</td>
                        <td>@post.ext</td>
                        <td>@ConvertBytesToKiloBytes(@post.fsize)</td>
                        <td style="overflow-y:scroll;overflow-x:hidden;">@post.com</td>
                        <td style="display: none">@(SetImageUsingStreamingAsync(post.tim.ToString(), thumbnailPlaceholderId))</td>
                    </tr>
                }
            }
        }
    </tbody>
</table>

